Proposed Client-Server interaction
==================================

To execute a server call, the client opens the daemon's UNIX domain
socket (as specified by SYSCONFDIR/socket-file), and sends across the
following data:

Command Header
--------------
Size	Type	Description
1	int	Protocol number (always 3)
2	int	Command header length
varies	zstring	Command name
varies	zstring	Domain name
varies	zstring	Pass phrase
varies	zstring	Command arguments
varies	N/A	Command data (optional)
                (not included in command header length)

The command name, domain name, and pass phrase are passed to an
authenticating shim which executes the command only if authentication
succeeds.  The command arguments are passed on the command line to the
command module after authentication, and the command data is passed on
standard input.

Response
--------
Size	Type	Description
1	int	Response code: one of the following
		0: OK -- operation succeeded
		1: Bad -- error in format or syntax
		2: Autherr -- authentication failed
		3: Error -- operation failed
varies	zstring	Response message
varies	N/A	Response data (optional)

Data types
----------
A "zstring" is a NUL terminated string

The command header is limited to 64K in length, primarily to limit the
possibility of attacks causing excessive memory allocation.

All integers are unsigned, sent MSB first.
